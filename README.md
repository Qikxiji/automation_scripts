# automation scripts

Далее идёт описание назначения скриптов, хранящихся в данном репозитории. Также файлы скриптов содержат комментарии, предназначенные для улучшения читаемости и понимания их целевого назначения.

### iptablesConf.sh
Cкрипт базовой конфигурации брандмауэра iptables и iptables-persistent для веб-сервера, а также fail2ban для защиты ssh от атаки перебором.

### installDocker.sh
Cкрипт автоматизации установки docker. Основан на [оффициальной инструкции](https://docs.docker.com/engine/install/ubuntu/) по установке Docker Engine на ubuntu. Производит удаление старых пакетов docker, обновление репозитория пакетного менеджера, устанавливает GPG ключи и сертификаты для репозитория docker, подключает репозиторий docker, устанавливает docker, проверяет работоспособность после установки.

### proxmoxRepository.sh
Cкрипт для начальной конфигурации репозиториев proxmox. По умолчанию после установки подключен платный enterprice репозиторий, который не используется, но жалуется, что у нас нет подписки. Скрипт отключает платный enterprice репозиторий (ссылка остается закомментированной), подключает оффициальный бесплатный аналог (создается отдельный файл в `/etc/apt/sources.list.d/`), и вносит мелкое изменение в файл конфигурации `/usr/share/javascript/proxmox-widget-toolkit/proxmoxlib.js` (изначальная конфигурация бэкапится в файл `proxmoxlib.js.bak` в той же директории), чтобы при авторизации в веб-интерфейсе не появлялось уведомление об отсутствии лицензии. В конце перезагружается сервис `pveproxy.service`. По окончании работы скрипта нужно заново авторизоваться через веб-интерфейс.

### clearLogs.sh
Cкрипт реализует удаление логов старше 2 дней. В качестве аргумента принимает путь до директории для очистки `-p` или ключ для вывода справки `-h`. Может чистить директороии только внутри /var/log/.Выводит информацию о количестве освобожденного места на диске.

### backupPostgres.sh
Скрипт предназначен для автоматизации резервного копирования БД Postgresql с помощью утилиты pg_dump. Список БД для резервного копирования заносится в массив `DB_NAMES` (остальные переменные также следует заполнить в соответствии с конфигурацией), для каждой БД создаётся дамп, проверяется, что он создан успешно. Ошибки при создании дампа вызывают остановку выполнения скрипта. В случае успешного создания дампа, он сжимается с помощью gzip и располагается в `BACKUP_DIR`. В `LOG_PATH` логируется информация о времени начала создания бэкпапа, о времени окончания, а также об успешности (SUCCEED/FAILED) создания дампа.

### bcakupAuto.sh
Cкрипт создает по указанному в `$BACKUP_LOCATION` пути резервную копию указанной в `$BACKUP_SOURCE` директории с меткой даты и времени в названии. Резервная копия создается в формате .tar.gz. Параметры задаются внутри скрипта. Для выполнения резервного копирования на вход ничего не передается. Для вывода пояснения предусмотрена справка при вводе параметра `-h`.

### getoptsPing.sh
Cкрипт написан для практического изучения команды getopts. Демонстрирует использование getopts для обработки аргументов командной строки на примере параметров для команды ping



